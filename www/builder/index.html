<!doctype html>
<html lang="en">

<head>
	<!-- Required meta tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<!-- CSS -->
	<script src="/js/js.cookie.min.js"></script>
	<noscript><link id="theme" rel="stylesheet" href="/css/bootstrap-light.min.css"></noscript>
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp"
	crossorigin="anonymous">


	<title>LegendHUB - Builder</title>
</head>

<body ng-app="legendwiki-app" ng-controller="builder">
	<lh-header></lh-header>
	<div class="container-fluid">
		<div class="row">
			<div class="col-lg-6 col-12 mb-4">
				<div class="card border-primary h-100">
					<div class="card-header py-2">
						<h4 class="mb-0">Character</h4>
					</div>
					<div class="card-body py-2">
						<div class="input-group">
							<select class="custom-select" ng-model="selectedListIndex" ng-change="onListChanged()">
								<option ng-repeat="list in allLists track by $index" ng-value="$index">{{list.Name}}</option>
							</select>
							<div class="input-group-append">
								<button class="btn btn-outline-secondary" type="button" data-toggle="modal" data-target="#editCharacterModal"><i class="fas fa-edit"></i></button>
								<button class="btn btn-outline-secondary" type="button" data-toggle="modal" data-target="#addCharacterModal"><i class="fas fa-plus"></i></button>
								<button class="btn btn-outline-danger" type="button" ng-click="openDeleteModal()" data-toggle="modal" data-target="#deleteCharacterModal"><i class="fas fa-trash"></i></button>
							</div>
						</div>
						<br />
						<button type="button" class="btn btn-primary float-right" ng-click="openClearModal()">Clear Items</button>
					</div>
				</div>
			</div>
			<div class="col-lg-6 col-12 mb-4">
				<div class="card border-primary h-100 pb-0">
					<div class="card-header py-2">
						<h4 class="mb-0">Base Stats</h4>
					</div>
					<div class="card-body py-2">
						<div class="row">
							<div class="form-group col-4 col-sm-2 text-center">
								<label class="col-form-label col-form-label-sm" for="strInput">Str</label>
								<input type="number" id="strInput" class="form-control form-control-sm" ng-model="selectedList.baseStats.Strength" ng-change="onStatChanged()" ng-model-options="{debounce:250}">
								<span ng-show="showStatQuests()">3</span>
							</div>
							<div class="form-group col-4 col-sm-2 text-center">
								<label class="col-form-label col-form-label-sm" for="minInput">Min</label>
								<input type="number" id="minInput" class="form-control form-control-sm" ng-model="selectedList.baseStats.Mind" ng-change="onStatChanged()" ng-model-options="{debounce:250}">
								<span ng-show="showStatQuests()">3</span>
							</div>
							<div class="form-group col-4 col-sm-2 text-center">
								<label class="col-form-label col-form-label-sm" for="dexInput">Dex</label>
								<input type="number" id="dexInput" class="form-control form-control-sm" ng-model="selectedList.baseStats.Dexterity" ng-change="onStatChanged()" ng-model-options="{debounce:250}">
								<span ng-show="showStatQuests()">3</span>
							</div>
							<div class="form-group col-4 col-sm-2 text-center">
								<label class="col-form-label col-form-label-sm" for="conInput">Con</label>
								<input type="number" id="conInput" class="form-control form-control-sm" ng-model="selectedList.baseStats.Constitution" ng-change="onStatChanged()" ng-model-options="{debounce:250}">
								<span ng-show="showStatQuests()">3</span>
							</div>
							<div class="form-group col-4 col-sm-2 text-center">
								<label class="col-form-label col-form-label-sm" for="perInput">Per</label>
								<input type="number" id="perInput" class="form-control form-control-sm" ng-model="selectedList.baseStats.Perception" ng-change="onStatChanged()" ng-model-options="{debounce:250}">
								<span ng-show="showStatQuests()">3</span>
							</div>
							<div class="form-group col-4 col-sm-2 text-center">
								<label class="col-form-label col-form-label-sm" for="spiInput">Spi</label>
								<input type="number" id="spiInput" class="form-control form-control-sm" ng-model="selectedList.baseStats.Spirit" ng-change="onStatChanged()" ng-model-options="{debounce:250}">
								<span ng-show="showStatQuests()">13</span>
							</div>
						</div>
						<p ng-show="showStatError" class="text-danger">Base stats should add up to either 198 or 244.</p>
						<div class="row">
							<div class="input-group input-group-sm col-12 col-sm-6 mb-3 mb-sm-0">
								<div class="input-group-prepend">
									<label class="input-group-text" for="longhouseSelect">Longhouse</label>
								</div>
								<select class="custom-select custom-select-sm" id="longhouseSelect" ng-model="selectedList.baseStats.Longhouse" ng-change="saveClientSideData()" ng-model-options="{debounce:250}">
									<option ng-value="-1">-</option>
									<option ng-repeat="house in longhouseList" ng-value="$index">{{::house}}</option>
								</select>
							</div>
							<div class="input-group input-group-sm col-12 col-sm-6">
								<div class="input-group-prepend">
									<label class="input-group-text" for="amuletSelect">Amulet</label>
								</div>
								<select class="custom-select custom-select-sm" id="amuletSelect" ng-model="selectedList.baseStats.Amulet" ng-change="saveClientSideData()" ng-model-options="{debounce:250}">
									<option ng-value="-1">-</option>
									<option ng-repeat="amulet in amuletList" ng-value="$index">{{::amulet}}</option>
								</select>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-12">
				<div class="card">
					<div class="card-header" style="cursor: pointer;" data-toggle="modal" data-target="#columnsModal">
						Hide/Show Columns
					</div>
				</div>
			</div>
		</div>
		<br />
		<div class="row">
			<div class="table-responsive" ng-cloak>
				<table class="table table-striped table-hover table-sm table-bordered">
					<thead class="thead-dark">
						<tr>
							<th scope="col" class="text-center">Slot</th>
							<th scope="col" class="text-center">Name</th>
							<th scope="col" ng-repeat="stat in statInfo" ng-if="stat.showColumn && stat.var !== 'Name' && stat.var !== 'Slot'" class="text-center">{{::stat.short}}</th>
						</tr>
					</thead>
					<tbody>
						<tr class="bg-secondary text-white">
							<td></td>
							<td class="text-center">Total</td>
                            <td ng-repeat="stat in statInfo" ng-if="stat.showColumn && stat.var !== 'Name' && stat.var !== 'Slot'" class="text-center" ng-class="{'text-monospace': stat.var === 'AlignRestriction'}" ng-style="stat.var === 'AlignRestriction' && {'white-space':'pre'}" ng-trim="!stat.var === 'AlignRestriction'">{{getStatTotal(stat.var)}}</td>
						</tr>
						<tr ng-repeat="item in selectedList.items track by $index">
							<td ng-class="anyItemRestrictions($index) ? 'bg-danger' : 'bg-primary'" class="bg-primary text-white text-center py-md-1 py-lg-0" data-toggle="tooltip" title="{{getItemRestrictionText($index)}}" nowrap lh-tooltip><span ng-show="anyItemRestrictions($index)"><i class="fas fa-question-circle"></i>&nbsp;</span>{{::slots[item.Slot]}}</td>
							<th scope="row" ng-click="onRowClicked($index)" style="cursor: pointer;" class="py-1 py-lg-0">
								<a href="/items/details.html?id={{item.Id}}" target="_blank" ng-click="$event.stopPropagation()" ng-show="item.Id"><i class="fas fa-link fa-lg"></i></a>&nbsp;{{item.Name}}</th>
							<td ng-repeat="stat in statInfo" ng-if="stat.showColumn && stat.var !== 'Name' && stat.var !== 'Slot'" class="text-center py-1 py-lg-0" ng-click="onRowClicked($parent.$parent.$index)" style="cursor: pointer;">
								<span ng-if="stat.type == 'bool'">
									<i class="{{item[stat.var] == 1 ? 'text-success fas fa-check' : 'text-danger fas fa-times'}}"></i>
								</span>
								<span ng-if="stat.type === 'int' || stat.type === 'decimal' || stat.type === 'string'">{{item[stat.var]}}</span>
                                <span ng-if="stat.type === 'select'" ng-class="{'text-monospace': stat.var === 'AlignRestriction'}" ng-style="stat.var === 'AlignRestriction' && {'white-space':'pre'}" ng-trim="!stat.var === 'AlignRestriction'">{{ selectShortOptions[stat.var][item[stat.var]] }}</span>
							</td>
						</tr>
						<tr class="bg-dark text-white">
							<td class="text-center">Slot</td>
							<td class="text-center">Name</td>
							<td ng-repeat="stat in statInfo" ng-if="stat.showColumn && stat.var !== 'Name' && stat.var !== 'Slot'" class="text-center">{{stat.short}}</td>
						</tr>
						<tr class="bg-secondary text-white">
							<td></td>
							<td class="text-center">Total</td>
							<td ng-repeat="stat in statInfo" ng-if="stat.showColumn && stat.var !== 'Name' && stat.var !== 'Slot'" class="text-center">{{getStatTotal(stat.var)}}</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
		<div class="modal" tabindex="-1" role="dialog" id="itemChoiceModal">
			<div class="modal-dialog modal-xl" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title">Choose Item</h5>
						<button type="button" class="close" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>
					<div class="modal-body">
						<div id="searchAccordian" ng-cloak>
							<form ng-submit="search()">
								<div class="row">
									<span class="text-danger" ng-show="searchError != ''">{{searchError}}</span>
								</div>
								<div class="row">
									<div class="input-group col-12">
										<div class="input-group-prepend">
											<span class="input-group-text">
												<i class="fas fa-search"></i>
											</span>
										</div>
										<input type="text" ng-model="searchString" ng-model-options="{debounce: 250}" id="itemChoiceSearch" class="form-control" placeholder="Search..." ng-change="onSearchChange()" />
										<div class="input-group-append">
											<button class="btn btn-outline-primary" type="submit">Search</button>
										</div>
									</div>
								</div>
							</form>
							<br />
							<div class="row">
								<div class="table-responsive" ng-cloak>
									<table class="table table-striped table-sm">
										<thead class="thead-dark">
											<tr>
												<th scope="col" class="text-center">Slot</th>
												<th scope="col" class="text-center">Name</th>
												<th scope="col" ng-repeat="stat in statInfo" ng-if="stat.showColumn && stat.var !== 'Name' && stat.var !== 'Slot'" class="text-center">{{::stat.short}}</th>
											</tr>
										</thead>
										<tbody>
											<tr class="bg-secondary text-white">
												<td></td>
												<td class="text-center">Total</td>
												<td ng-repeat="stat in statInfo" ng-if="stat.showColumn && stat.var !== 'Name' && stat.var !== 'Slot'" class="text-center" ng-class="{'text-monospace': stat.var === 'AlignRestriction'}" ng-style="stat.var === 'AlignRestriction' && {'white-space':'pre'}" ng-trim="!stat.var === 'AlignRestriction'">{{getStatTotal(stat.var)}}</td>
											</tr>
											<tr>
												<td class="bg-primary text-white text-center py-md-1 py-lg-0" nowrap>{{slots[currentItem.Slot]}}</td>
												<th scope="row" class="py-1 py-lg-0">
													<a href="/items/details.html?id={{currentItem.Id}}" target="_blank" ng-click="$event.stopPropagation()" ng-show="currentItem.Id"><i class="fas fa-link fa-lg"></i></a>&nbsp;{{currentItem.Name}}</th>
												<td ng-repeat="stat in statInfo" ng-if="stat.showColumn && stat.var !== 'Name' && stat.var !== 'Slot'" class="text-center py-1 py-lg-0" style="cursor: pointer;">
													<span ng-if="stat.type == 'bool'">
														<i class="{{currentItem[stat.var] == 1 ? 'text-success fas fa-check' : 'text-danger fas fa-times'}}"></i>
													</span>
													<span ng-if="stat.type === 'int' || stat.type === 'decimal' || stat.type === 'string'">{{currentItem[stat.var]}}</span>
													<span ng-if="stat.type === 'select'" ng-class="{'text-monospace': stat.var === 'AlignRestriction'}" ng-style="stat.var === 'AlignRestriction' && {'white-space':'pre'}" ng-trim="!stat.var === 'AlignRestriction'">{{ selectShortOptions[stat.var][currentItem[stat.var]] }}</span>
												</td>
											</tr>
										</tbody>
									</table>
								</div>
							</div>
							<br />
							<div class="row">
								<div class="table-responsive" ng-cloak>
									<table class="table table-striped table-sm table-hover">
										<thead class="thead-dark">
											<tr>
												<th scope="col" class="clickable" ng-click="onColumnHeaderClicked('Name')" nowrap>Name&nbsp;<i ng-class="getSortClass('Name')"></i></th>
												<th scope="col" class="clickable" ng-repeat="stat in statInfo" ng-if="stat.showColumn && stat.var !== 'Name' && stat.var !== 'Slot'" ng-click="onColumnHeaderClicked(stat.var)" nowrap>{{stat.short}}&nbsp;<i ng-class="getSortClass(stat.var)"></i></th>
											</tr>
										</thead>
										<tbody>
											<tr ng-repeat="item in getFilteredSearchResults()" style="cursor: pointer;" ng-click="onSearchRowClicked(item)">
												<td scope="row">
													<a href="/items/details.html?id={{item.Id}}" target="_blank" ng-click="$event.stopPropagation()" ng-show="item.Id"><i class="fas fa-link fa-lg"></i></a>&nbsp;{{item['Name']}}</td>
                                                <td ng-repeat="stat in statInfo" ng-if="stat.showColumn && stat.var !== 'Name' && stat.var !== 'Slot'" ng-class="{'text-monospace': stat.var === 'AlignRestriction'}" ng-style="stat.var === AlignRestriction && {'white-space': 'pre'}" ng-trim="stat.var !== 'AlignRestriction'}">
													<span ng-if="stat.type == 'bool'">
														<i class="{{item[stat.var] == 1 ? 'text-success fas fa-check' : 'text-danger fas fa-times'}}"></i>
													</span>
													<span ng-if="stat.type === 'int' || stat.type === 'decimal' || stat.type === 'string'">{{item[stat.var]}}</span>
                                                    <span ng-if="stat.type === 'select'">
                                                        {{ selectShortOptions[stat.var][item[stat.var]] }}
                                                    </span>
												</td>
											</tr>
										</tbody>
									</table>
								</div>
							</div>
                            <div class="row">
							    <nav class="col-12" aria-label="Item result navigation" ng-if="totalPages > 1">
								    <ul class="pagination">
									    <li class="page-item">
										    <a class="page-link" ng-click="onPreviousClicked()" href aria-label="Previous">
											    <span aria-hidden="true"><i class="fas fa-chevron-left"></i></span>
											    <span class="sr-only">Previous</span>
										    </a>
									    </li>
									    <li class="page-item" ng-repeat="i in getNumberArray(totalPages) track by $index" ng-class="{active: $index == currentPage - 1}"><a class="page-link" ng-click="onPageClicked($index)" href>{{$index + 1}}</a></li>
									    <li class="page-item">
										    <a class="page-link" ng-click="onNextClicked()" href aria-label="Next">
											    <span aria-hidden="true"><i class="fas fa-chevron-right"></i></span>
											    <span class="sr-only">Next</span>
										    </a>
									    </li>
								    </ul>
							    </nav>
                            </div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="modal" tabindex="-1" role="dialog" id="addCharacterModal">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title">Add Character</h5>
						<button type="button" class="close" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>
					<div class="modal-body">
						<form name="addCharacterForm" ng-submit="addCharacter()">
							<div class="row">
								<div class="input-group col-12">
									<div class="input-group-prepend">
										<span class="input-group-text">Name</span>
									</div>
									<input name="nameInput" id="addCharacterModalName" type="text" ng-model="addCharacterModel.Name" class="form-control" ng-pattern="/^[A-Za-z\s\d]*$/" ng-change="validateAddCharacter()" ng-model-options="{debounce: 250}" />
									<div class="input-group-append">
										<button class="btn btn-outline-primary" type="submit" ng-disabled="!addCharacterForm.$valid">Add</button>
									</div>
								</div>
							</div>
							<div class="row">
								<p ng-show="addCharacterForm.nameInput.$error.pattern" class="text-danger">Invalid characters.</p>
								<p ng-show="addCharacterForm.nameInput.$error.duplicate" class="text-danger">Duplicate character name.</p>
								<p ng-show="addCharacterForm.nameInput.$error.limit" class="text-danger">Limit of 20,000 lists reached.</p>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
		<div class="modal" tabindex="-1" role="dialog" id="editCharacterModal">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title">Edit Character</h5>
						<button type="button" class="close" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>
					<div class="modal-body">
						<form name="editCharacterForm" ng-submit="editCharacter()">
							<div class="row">
								<div class="input-group col-12">
									<div class="input-group-prepend">
										<span class="input-group-text">Name</span>
									</div>
									<input name="nameInput" id="editCharacterModalName" type="text" ng-model="editCharacterModel.Name" class="form-control" ng-pattern="/^[A-Za-z]*$/" ng-change="validateEditCharacter()" ng-model-options="{debounce: 250}" />
									<div class="input-group-append">
										<button class="btn btn-outline-primary" type="submit" ng-disabled="!editCharacterForm.$valid">Save</button>
									</div>
								</div>
							</div>
							<div class="row">
								<p ng-show="editCharacterForm.nameInput.$error.pattern" class="text-danger">Invalid characters.</p>
								<p ng-show="editCharacterForm.nameInput.$error.duplicate" class="text-danger">Duplicate character name.</p>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
		<div class="modal" tabindex="-1" role="dialog" id="confirmModal">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title">Are you sure?</h5>
						<button type="button" class="close" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>
					<div class="modal-body">
						<p>{{confirmMessage}}</p>
						<button class="btn btn-primary float-right" type="button" ng-click="confirm()">Yes</button>
					</div>
				</div>
			</div>
		</div>
	</div>
    <div ng-include="'/shared/columnsModal.html'"></div>

	<lh-footer></lh-footer>

	<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
	    crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/js/bootstrap-select.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
	    crossorigin="anonymous"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
	    crossorigin="anonymous"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.10/angular.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.10/angular-cookies.min.js"></script>
	<script src="/js/apps/legendwiki-app.js"></script>
	<script src="/js/controllers/builder/main.js"></script>
</body>

</html>
